/**
 * Silverback Game Engine v.0.0.5 - The Silverback Engine is typescript entity game framework.
 * Copyright (c) 2015 Gorillabyte
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 3 of the License, or
 * (at your option) any later version.
 * 
 * Visit http://www.silverbackengine.org for documentation, updates and examples.
 */
!function t(e,i,n){function s(r,h){if(!i[r]){if(!e[r]){var a="function"==typeof require&&require;if(!h&&a)return a(r,!0);if(o)return o(r,!0);var u=new Error("Cannot find module '"+r+"'");throw u.code="MODULE_NOT_FOUND",u}var p=i[r]={exports:{}};e[r][0].call(p.exports,function(t){var i=e[r][1][t];return s(i?i:t)},p,p.exports,t,e,i,n)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)s(n[r]);return s}({1:[function(t,e,i){var n=t("./NodePool"),s=t("./NodeList"),o=t("../utils/Dictionary"),r=function(){function t(t,e){this._nodeClass=t,this._engine=e,this._nodes=new s.NodeList,this._entities=new o.Dictionary,this._components=new o.Dictionary;var i=this._nodeClass.prototype;for(var r in i)if(i.hasOwnProperty(r)&&"types"!==r&&"next"!==r&&"previous"!==r&&"constructor"!==r&&"super"!==r&&"extend"!==r&&"entity"!==r){var h=i.types[r];this._components.add(h,r)}this._nodePool=new n.NodePool(this._nodeClass,this._components),this._nodePool.dispose(this._nodePool.get())}return Object.defineProperty(t.prototype,"nodeList",{get:function(){return this._nodes},enumerable:!0,configurable:!0}),t.prototype.newEntity=function(t){this.addIfMatch(t)},t.prototype.componentAddedToEntity=function(t,e){this.addIfMatch(t)},t.prototype.componentRemovedFromEntity=function(t,e){this._components.has(e)&&this.removeIfMatch(t)},t.prototype.removeEntity=function(t){this.removeIfMatch(t)},t.prototype.addIfMatch=function(t){if(!this._entities.has(t)){if(!this._components.forEach(function(e,i){return t.has(e)?void 0:"return"}))return;var e=this._nodePool.get();e.entity=t,this._components.forEach(function(i,n){e[n]=t.get(i)}),this._entities.add(t,e),t.componentRemoved.add(this.componentRemovedFromEntity,this),this._nodes.add(e)}},t.prototype.removeIfMatch=function(t){if(this._entities.getValue(t)){var e=this._entities.getValue(t);this._entities.remove(t),this._nodes.remove(e),this._engine.updating?(this._nodePool.cache(e),this._engine.updateComplete.add(this._releaseNodePoolCache,this)):this._nodePool.dispose(e)}},t.prototype._releaseNodePoolCache=function(){this._engine.updateComplete.remove(this._releaseNodePoolCache),this._nodePool.releaseCache()},t.prototype.cleanUp=function(){for(var t=this._nodes.head;t;t=t.next)this._entities.remove(t.entity);this._nodes.removeAll()},t}();i.ComponentMatchingFamily=r},{"../utils/Dictionary":9,"./NodeList":4,"./NodePool":5}],2:[function(t,e,i){var n=t("./EntityList"),s=t("./SceneList"),o=t("./SystemList"),r=t("../utils/Dictionary"),h=t("../utils/Signal"),a=t("./ComponentMatchingFamily"),u=function(){function t(){this.familyClass=a.ComponentMatchingFamily,this._entityList=new n.EntityList,this._sceneList=new s.SceneList,this._systemList=new o.SystemList,this._families=new r.Dictionary,this.updateComplete=new h.Signal}return Object.defineProperty(t.prototype,"entites",{get:function(){for(var t=[],e=this._entityList.head;e;e=e.next)t.push(e);return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scenes",{get:function(){for(var t=[],e=this._sceneList.head;e;e=e.next)t.push(e);return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"systems",{get:function(){for(var t=[],e=this._systemList.head;e;e=e.next)t.push(e);return t},enumerable:!0,configurable:!0}),t.prototype.addEntity=function(t){this._entityList.add(t),t.componentAdded.add(this._componentAdded,this),t.componentRemoved.add(this._componentRemoved,this),this._families.forEach(function(e,i){i.newEntity(t)})},t.prototype.removeEntity=function(t){t.componentAdded.remove(this._componentAdded,this),t.componentRemoved.remove(this._componentRemoved,this),this._families.forEach(function(e,i){i.removeEntity(t)}),this._entityList.remove(t)},t.prototype.removeAllEntities=function(){for(;this._entityList.head;)this.removeEntity(this._entityList.head)},t.prototype.addScene=function(t){this._sceneList.add(t)},t.prototype.removeScene=function(t){this._sceneList.remove(t)},t.prototype.removeAllScenes=function(){for(;this._sceneList.head;)this.removeScene(this._sceneList.head)},t.prototype.getScene=function(t){return this._sceneList.get(t)},t.prototype._componentAdded=function(t,e){this._families.forEach(function(i,n){n.componentAddedToEntity(t,e)})},t.prototype._componentRemoved=function(t,e){this._families.forEach(function(i,n){n.componentRemovedFromEntity(t,e)})},t.prototype.getNodeList=function(t){if(this._families.has(t))return this._families.getValue(t)._nodes;var e=new this.familyClass(t,this);this._families.add(t,e);for(var i=this._entityList.head;i;i=i.next)e.newEntity(i);return e.nodeList},t.prototype.releaseNodeList=function(t){this._families.has(t)&&this._families.getValue(t).cleanUp(),this._families.remove(t)},t.prototype.addSystem=function(t,e){t.priority=e,t.addToEngine(this),this._systemList.add(t)},t.prototype.getSystem=function(t){return this._systemList.get(t)},t.prototype.removeSystem=function(t){this._systemList.remove(t),t.removeFromEngine(this)},t.prototype.removeAllSystems=function(){for(;this._systemList.head;)this.removeSystem(this._systemList.head)},t.prototype.update=function(t){this.updating=!0;for(var e=this._systemList.head;e;e=e.next)e.update(t);this.updating=!1,this.updateComplete.dispatch()},t}();i.Engine=u},{"../utils/Dictionary":9,"../utils/Signal":10,"./ComponentMatchingFamily":1,"./EntityList":3,"./SceneList":6,"./SystemList":7}],3:[function(t,e,i){var n=function(){function t(){}return t.prototype.add=function(t){this.head?(this.tail.next=t,t.previous=this.tail,t.next=null,this.tail=t):(this.head=this.tail=t,t.next=t.previous=null)},t.prototype.remove=function(t){this.head===t&&(this.head=this.head.next),this.tail===t&&(this.tail=this.tail.previous),t.previous&&(t.previous.next=t.next),t.next&&(t.next.previous=t.previous)},t.prototype._removeAll=function(){for(;this.head;){var t=this.head;this.head=this.head.next,t.previous=null,t.next=null}this.tail=null},t}();i.EntityList=n},{}],4:[function(t,e,i){var n=t("../utils/Signal"),s=function(){function t(){this.head=null,this.tail=null,this.nodeAdded=new n.Signal,this.nodeRemoved=new n.Signal}return t.prototype.add=function(t){this.head?(this.tail.next=t,t.previous=this.tail,t.next=null,this.tail=t):(this.head=this.tail=t,t.next=t.previous=null),this.nodeAdded.dispatch(t)},t.prototype.remove=function(t){this.head===t&&(this.head=this.head.next),this.tail===t&&(this.tail=this.tail.previous),t.previous&&(t.previous.next=t.next),t.next&&(t.next.previous=t.previous),this.nodeRemoved.dispatch(t)},t.prototype.removeAll=function(){for(;this.head;){var t=this.head;this.head=t.next,t.previous=null,t.next=null,this.nodeRemoved.dispatch(t)}this.tail=null},t.prototype.empty=function(){return null===this.head},t.prototype.swap=function(t,e){if(t.previous===e)t.previous=e.previous,e.previous=t,e.next=t.next,t.next=e;else if(e.previous===t)e.previous=t.previous,t.previous=e,t.next=e.next,e.next=t;else{var i=t.previous;t.previous=e.previous,e.previous=i,i=t.next,t.next=e.next,e.next=i}this.head===t?this.head=e:this.head===e&&(this.head=t),this.tail===t?this.tail=e:this.tail===e&&(this.tail=t),t.previous&&(t.previous.next=t),e.previous&&(e.previous.next=e),t.next&&(t.next.previous=t),e.next&&(e.next.previous=e)},t.prototype.insertionSort=function(t){if(this.head!==this.tail)for(var e=this.head.next,i=e;i;i=e){e=i.next;for(var n=i.previous;n;n=n.previous)if(t(i,n)>=0){i!==n.next&&(this.tail===i&&(this.tail=i.previous),i.previous.next=i.next,i.next&&(i.next.previous=i.previous),i.next=n.next,i.previous=n,i.next.previous=i,n.next=i);break}n||(this.tail===i&&(this.tail=i.previous),i.previous.next=i.next,i.next&&(i.next.previous=i.previous),i.next=this.head,this.head.previous=i,i.previous=null,this.head=i)}},t.prototype.mergeSort=function(t){if(this.head!==this.tail){for(var e,i,n=this.head;n;){for(i=n;i.next&&t(i,i.next)<=0;)i=i.next;var s=i.next;n.previous=i.next=null,e.push(n),n=s}for(;e.length>1;);for(this.tail=this.head=e[0];this.tail.next;)this.tail=this.tail.next}},t.prototype._merge=function(t,e,i){var n,s;for(i(t,e)<=0?(s=n=t,t=t.next):(s=n=e,e=e.next);t&&e;)i(t,e)<=0?(n.next=t,t.previous=n,n=t,t=t.next):(n.next=e,e.previous=n,n=e,e=e.next);return t?(n.next=t,t.previous=n):(n.next=e,e.previous=n),s},t}();i.NodeList=s},{"../utils/Signal":10}],5:[function(t,e,i){var n=function(){function t(t,e){this._nodeClass=t,this._components=e}return t.prototype.get=function(){if(this._tail){var t=this._tail;return this._tail=this._tail.previous,t.previous=null,t}var e=new this._nodeClass;return e},t.prototype.dispose=function(t){this._components.forEach(function(e,i){t[i]=null}),t.entity=null,t.next=null,t.previous=this._tail,this._tail=t},t.prototype.cache=function(t){t.previous=this._cacheTail,this._cacheTail=t},t.prototype.releaseCache=function(){for(;this._cacheTail;){var t=this._cacheTail;this._cacheTail=t.previous,t.next=null,t.previous=this._tail,this._tail=t}},t}();i.NodePool=n},{}],6:[function(t,e,i){var n=function(){function t(){}return t.prototype.add=function(t){this.head?(this.tail.next=t,t.previous=this.tail,t.next=null,this.tail=t):(this.head=this.tail=t,t.next=t.previous=null)},t.prototype.remove=function(t){this.head===t&&(this.head=this.head.next),this.tail===t&&(this.tail=this.tail.previous),t.previous&&(t.previous.next=t.next),t.next&&(t.next.previous=t.previous)},t.prototype._removeAll=function(){for(;this.head;){var t=this.head;this.head=this.head.next,t.previous=null,t.next=null}this.tail=null},t.prototype.get=function(t){for(var e=this.head;e;e=e.next)if(e.is(t))return e;return null},t}();i.SceneList=n},{}],7:[function(t,e,i){var n=function(){function t(){}return t.prototype.add=function(t){if(this.head){for(var e=this.tail;e&&!(e.priority<=t.priority);e=e.previous);e===this.tail?(this.tail.next=t,t.previous=this.tail,t.next=null,this.tail=t):e?(t.next=e.next,t.previous=e,e.next.previous=t,e.next=t):(t.next=this.head,t.previous=null,this.head.previous=t,this.head=t)}else this.head=this.tail=t,t.next=t.previous=null},t.prototype.remove=function(t){this.head===t&&(this.head=this.head.next),this.tail===t&&(this.tail=this.tail.previous),t.previous&&(t.previous.next=t.next),t.next&&(t.next.previous=t.previous)},t.prototype.removeAll=function(){for(;this.head;){var t=this.head;this.head=this.head.next,t.previous=null,t.next=null}this.tail=null},t.prototype.get=function(t){for(var e=this.head;e;e=e.next)if(e.is(t))return e;return null},t}();i.SystemList=n},{}],8:[function(t,e,i){var n=t("./core/Engine");i.Engine=n.Engine},{"./core/Engine":2}],9:[function(t,e,i){var n=function(){function t(){this._keys=[],this._values=[]}return t.prototype.add=function(t,e){var i=this.getIndex(t);i>=0?this._values[i]=e:(this._keys.push(t),this._values.push(e))},t.prototype.remove=function(t){var e=this.getIndex(t);if(e>=0){var i=this._values[e];return this._keys.splice(e,1),this._values.splice(e,1),i}throw"Key does not exist"},t.prototype.getValue=function(t){var e=null,i=this.getIndex(t);return i>=0&&(e=this._values[i]),e},t.prototype.getIndex=function(t){for(var e,i=0,n=this._keys.length;n>i;++i)if(e=this._keys[i],e===t)return i;return-1},t.prototype.has=function(t){var e,i=0,n=this._keys.length;for(i;n>i;++i)if(e=this._keys[i],e===t)return!0;return!1},t.prototype.values=function(){for(var t,e,i=0,n=this._keys.length,s=[];n>i;++i)t=this._keys[i],e=this._values[i],s.push(e);return s},t.prototype.forEach=function(t){for(var e,i,n=0,s=this._keys.length;s>n;++n){e=this._keys[n],i=this._values[n];var o=t(e,i);if("return"===o)return!1}return!0},t}();i.Dictionary=n},{}],10:[function(t,e,i){var n=t("./SignalBinding"),s=function(){function t(){this._bindings=[],this._prevParams=null,this.memorize=!1,this._shouldPropagate=!0,this.active=!0}return t.prototype.validateListener=function(t,e){if("function"!=typeof t)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",e))},t.prototype._registerListener=function(t,e,i,s){var o,r=this._indexOfListener(t,i);if(-1!==r){if(o=this._bindings[r],o.isOnce()!==e)throw new Error("You cannot add"+(e?"":"Once")+"() then add"+(e?"Once":"")+"() the same listener without removing the relationship first.")}else o=new n.SignalBinding(this,t,e,i,s),this._addBinding(o);return this.memorize&&this._prevParams&&o.execute(this._prevParams),o},t.prototype._addBinding=function(t){var e=this._bindings.length;do--e;while(this._bindings[e]&&t.priority<=this._bindings[e].priority);this._bindings.splice(e+1,0,t)},t.prototype._indexOfListener=function(t,e){for(var i,n=this._bindings.length;n--;)if(i=this._bindings[n],i.getListener()===t&&i.context===e)return n;return-1},t.prototype.has=function(t,e){return void 0===e&&(e=null),-1!==this._indexOfListener(t,e)},t.prototype.add=function(t,e,i){return void 0===e&&(e=null),void 0===i&&(i=0),this.validateListener(t,"add"),this._registerListener(t,!1,e,i)},t.prototype.addOnce=function(t,e,i){return void 0===e&&(e=null),void 0===i&&(i=0),this.validateListener(t,"addOnce"),this._registerListener(t,!0,e,i)},t.prototype.remove=function(t,e){void 0===e&&(e=null),this.validateListener(t,"remove");var i=this._indexOfListener(t,e);return-1!==i&&(this._bindings[i]._destroy(),this._bindings.splice(i,1)),t},t.prototype.removeAll=function(){for(var t=this._bindings.length;t--;)this._bindings[t]._destroy();this._bindings.length=0},t.prototype.getNumListeners=function(){return this._bindings.length},t.prototype.halt=function(){this._shouldPropagate=!1},t.prototype.dispatch=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];if(this.active){var i,n=this._bindings.length;if(this.memorize&&(this._prevParams=t),n){i=this._bindings.slice(0),this._shouldPropagate=!0;do n--;while(i[n]&&this._shouldPropagate&&i[n].execute(t)!==!1)}}},t.prototype.forget=function(){this._prevParams=null},t.prototype.dispose=function(){this.removeAll(),delete this._bindings,delete this._prevParams},t.prototype.toString=function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"},t.VERSION="1.0.0",t}();i.Signal=s},{"./SignalBinding":11}],11:[function(t,e,i){var n=function(){function t(t,e,i,n,s){void 0===s&&(s=0),this.active=!0,this.params=null,this._listener=e,this._isOnce=i,this.context=n,this._signal=t,this.priority=s||0}return t.prototype.execute=function(t){var e,i;return this.active&&this._listener&&(i=this.params?this.params.concat(t):t,e=this._listener.apply(this.context,i),this._isOnce&&this.detach()),e},t.prototype.detach=function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},t.prototype.isBound=function(){return!!this._signal&&!!this._listener},t.prototype.isOnce=function(){return this._isOnce},t.prototype.getListener=function(){return this._listener},t.prototype.getSignal=function(){return this._signal},t.prototype._destroy=function(){delete this._signal,delete this._listener,delete this.context},t.prototype.toString=function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"},t}();i.SignalBinding=n},{}]},{},[8]);
//# sourceMappingURL=silverback.min.js.map
