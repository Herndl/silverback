/**
 * silverback v.0.0.5 - The silverback engine is typescript entity game framework without rendering contrains.
 * Copyright (c) 2015 Gorillabyte
 * ISC
 */
var silverback;!function(t){var e;!function(t){var e=function(){function t(){this._keys=[],this._values=[]}return t.prototype.add=function(t,e){var i=this.getIndex(t);i>=0?this._values[i]=e:(this._keys.push(t),this._values.push(e))},t.prototype.remove=function(t){var e=this.getIndex(t);if(e>=0){var i=this._values[e];return this._keys.splice(e,1),this._values.splice(e,1),i}throw"Key does not exist"},t.prototype.getValue=function(t){var e=null,i=this.getIndex(t);return i>=0&&(e=this._values[i]),e},t.prototype.getIndex=function(t){for(var e,i=0,n=this._keys.length;n>i;++i)if(e=this._keys[i],e===t)return i;return-1},t.prototype.has=function(t){var e,i=0,n=this._keys.length;for(i;n>i;++i)if(e=this._keys[i],e===t)return!0;return!1},t.prototype.values=function(){for(var t,e,i=0,n=this._keys.length,o=[];n>i;++i)t=this._keys[i],e=this._values[i],o.push(e);return o},t.prototype.forEach=function(t){for(var e,i,n=0,o=this._keys.length;o>n;++n){e=this._keys[n],i=this._values[n];var s=t(e,i);if("return"===s)return!1}return!0},t}();t.Dictionary=e}(e=t.utils||(t.utils={}))}(silverback||(silverback={}));var silverback;!function(t){var e;!function(t){var e=function(){function e(){this._bindings=[],this._prevParams=null,this.memorize=!1,this._shouldPropagate=!0,this.active=!0}return e.prototype.validateListener=function(t,e){if("function"!=typeof t)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",e))},e.prototype._registerListener=function(e,i,n,o){var s,r=this._indexOfListener(e,n);if(-1!==r){if(s=this._bindings[r],s.isOnce()!==i)throw new Error("You cannot add"+(i?"":"Once")+"() then add"+(i?"Once":"")+"() the same listener without removing the relationship first.")}else s=new t.SignalBinding(this,e,i,n,o),this._addBinding(s);return this.memorize&&this._prevParams&&s.execute(this._prevParams),s},e.prototype._addBinding=function(t){var e=this._bindings.length;do--e;while(this._bindings[e]&&t.priority<=this._bindings[e].priority);this._bindings.splice(e+1,0,t)},e.prototype._indexOfListener=function(t,e){for(var i,n=this._bindings.length;n--;)if(i=this._bindings[n],i.getListener()===t&&i.context===e)return n;return-1},e.prototype.has=function(t,e){return void 0===e&&(e=null),-1!==this._indexOfListener(t,e)},e.prototype.add=function(t,e,i){return void 0===e&&(e=null),void 0===i&&(i=0),this.validateListener(t,"add"),this._registerListener(t,!1,e,i)},e.prototype.addOnce=function(t,e,i){return void 0===e&&(e=null),void 0===i&&(i=0),this.validateListener(t,"addOnce"),this._registerListener(t,!0,e,i)},e.prototype.remove=function(t,e){void 0===e&&(e=null),this.validateListener(t,"remove");var i=this._indexOfListener(t,e);return-1!==i&&(this._bindings[i]._destroy(),this._bindings.splice(i,1)),t},e.prototype.removeAll=function(){for(var t=this._bindings.length;t--;)this._bindings[t]._destroy();this._bindings.length=0},e.prototype.getNumListeners=function(){return this._bindings.length},e.prototype.halt=function(){this._shouldPropagate=!1},e.prototype.dispatch=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];if(this.active){var i,n=this._bindings.length;if(this.memorize&&(this._prevParams=t),n){i=this._bindings.slice(0),this._shouldPropagate=!0;do n--;while(i[n]&&this._shouldPropagate&&i[n].execute(t)!==!1)}}},e.prototype.forget=function(){this._prevParams=null},e.prototype.dispose=function(){this.removeAll(),delete this._bindings,delete this._prevParams},e.prototype.toString=function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"},e.VERSION="1.0.0",e}();t.Signal=e}(e=t.utils||(t.utils={}))}(silverback||(silverback={}));var silverback;!function(t){var e;!function(t){var e=function(){function t(t,e,i,n,o){void 0===o&&(o=0),this.active=!0,this.params=null,this._listener=e,this._isOnce=i,this.context=n,this._signal=t,this.priority=o||0}return t.prototype.execute=function(t){var e,i;return this.active&&this._listener&&(i=this.params?this.params.concat(t):t,e=this._listener.apply(this.context,i),this._isOnce&&this.detach()),e},t.prototype.detach=function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},t.prototype.isBound=function(){return!!this._signal&&!!this._listener},t.prototype.isOnce=function(){return this._isOnce},t.prototype.getListener=function(){return this._listener},t.prototype.getSignal=function(){return this._signal},t.prototype._destroy=function(){delete this._signal,delete this._listener,delete this.context},t.prototype.toString=function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"},t}();t.SignalBinding=e}(e=t.utils||(t.utils={}))}(silverback||(silverback={}));var silverback;!function(t){var e;!function(e){var i=function(){function e(i){void 0===i&&(i=""),this._components=new t.utils.Dictionary,this.componentAdded=new t.utils.Signal,this.componentRemoved=new t.utils.Signal,i?this.name=i:this.name="_entity"+ ++e.nameCount}return e.prototype.add=function(t,e){return"undefined"==typeof e&&(e=t.constructor),this._components.has(e)&&this.remove(e),this._components.add(e,t),this.componentAdded.dispatch(this,e),this},e.prototype.remove=function(t){var e=this._components.getValue(t);return e?(this._components.remove(t),this.componentRemoved.dispatch(this,t),e):null},e.prototype.get=function(t){return this._components.getValue(t)},e.prototype.getAll=function(){var t=[];return this._components.forEach(function(e,i){t.push(i)}),t},e.prototype.has=function(t){return this._components.has(t)},Object.defineProperty(e.prototype,"scene",{set:function(t){this._addedToScene=t},enumerable:!0,configurable:!0}),e.nameCount=0,e}();e.Entity=i}(e=t.core||(t.core={}))}(silverback||(silverback={}));var silverback;!function(t){var e;!function(t){var e=function(){function t(){}return t.prototype.add=function(t){this.head?(this.tail.next=t,t.previous=this.tail,t.next=null,this.tail=t):(this.head=this.tail=t,t.next=t.previous=null)},t.prototype.remove=function(t){this.head===t&&(this.head=this.head.next),this.tail===t&&(this.tail=this.tail.previous),t.previous&&(t.previous.next=t.next),t.next&&(t.next.previous=t.previous)},t.prototype._removeAll=function(){for(;this.head;){var t=this.head;this.head=this.head.next,t.previous=null,t.next=null}this.tail=null},t}();t.EntityList=e}(e=t.core||(t.core={}))}(silverback||(silverback={}));var silverback;!function(t){var e;!function(e){var i=function(){function e(i){void 0===i&&(i=""),this._entities=new t.utils.Dictionary,this.entityAdded=new t.utils.Signal,this.entityRemoved=new t.utils.Signal,this._entityList=new t.core.EntityList,i?this._name=i:this._name="_scene"+ ++e.nameCount}return e.prototype.addEntity=function(t,e){return"undefined"==typeof e&&(e=t.constructor),this._entityList.add(t),this.entityAdded.dispatch(this,e),t.scene=this,this},e.prototype.removeEntity=function(t){this._entityList.remove(t)},e.prototype.getEntityWithName=function(t){for(var e=this._entityList.head;e;e=e.next)if(e.name===t)return e},e.prototype.getEntityWithComponent=function(t,e){for(var i=this._entityList.head;i;i=i.next)if(i.has(e)&&i.get(e).displayObject===t)return i;return null},e.prototype.getAllEntity=function(){var t=[];return this._entities.forEach(function(e,i){t.push(i)}),t},e.prototype.hasEntity=function(t){return this._entities.has(t)},e.prototype.is=function(t){return t.prototype.isPrototypeOf(this)},e.nameCount=0,e}();e.Scene=i}(e=t.core||(t.core={}))}(silverback||(silverback={}));var silverback;!function(t){var e;!function(t){var e=function(){function t(){}return t.prototype.add=function(t){this.head?(this.tail.next=t,t.previous=this.tail,t.next=null,this.tail=t):(this.head=this.tail=t,t.next=t.previous=null)},t.prototype.remove=function(t){this.head===t&&(this.head=this.head.next),this.tail===t&&(this.tail=this.tail.previous),t.previous&&(t.previous.next=t.next),t.next&&(t.next.previous=t.previous)},t.prototype._removeAll=function(){for(;this.head;){var t=this.head;this.head=this.head.next,t.previous=null,t.next=null}this.tail=null},t.prototype.get=function(t){for(var e=this.head;e;e=e.next)if(e.is(t))return e;return null},t}();t.SceneList=e}(e=t.core||(t.core={}))}(silverback||(silverback={}));var silverback;!function(t){var e;!function(t){var e=function(){function t(){this.entity=null,this.previous=null,this.next=null}return t}();t.Node=e}(e=t.core||(t.core={}))}(silverback||(silverback={}));var silverback;!function(t){var e;!function(e){var i=function(){function e(){this.head=null,this.tail=null,this.nodeAdded=new t.utils.Signal,this.nodeRemoved=new t.utils.Signal}return e.prototype.add=function(t){this.head?(this.tail.next=t,t.previous=this.tail,t.next=null,this.tail=t):(this.head=this.tail=t,t.next=t.previous=null),this.nodeAdded.dispatch(t)},e.prototype.remove=function(t){this.head===t&&(this.head=this.head.next),this.tail===t&&(this.tail=this.tail.previous),t.previous&&(t.previous.next=t.next),t.next&&(t.next.previous=t.previous),this.nodeRemoved.dispatch(t)},e.prototype.removeAll=function(){for(;this.head;){var t=this.head;this.head=t.next,t.previous=null,t.next=null,this.nodeRemoved.dispatch(t)}this.tail=null},e.prototype.empty=function(){return null===this.head},e.prototype.swap=function(t,e){if(t.previous===e)t.previous=e.previous,e.previous=t,e.next=t.next,t.next=e;else if(e.previous===t)e.previous=t.previous,t.previous=e,t.next=e.next,e.next=t;else{var i=t.previous;t.previous=e.previous,e.previous=i,i=t.next,t.next=e.next,e.next=i}this.head===t?this.head=e:this.head===e&&(this.head=t),this.tail===t?this.tail=e:this.tail===e&&(this.tail=t),t.previous&&(t.previous.next=t),e.previous&&(e.previous.next=e),t.next&&(t.next.previous=t),e.next&&(e.next.previous=e)},e.prototype.insertionSort=function(t){if(this.head!==this.tail)for(var e=this.head.next,i=e;i;i=e){e=i.next;for(var n=i.previous;n;n=n.previous)if(t(i,n)>=0){i!==n.next&&(this.tail===i&&(this.tail=i.previous),i.previous.next=i.next,i.next&&(i.next.previous=i.previous),i.next=n.next,i.previous=n,i.next.previous=i,n.next=i);break}n||(this.tail===i&&(this.tail=i.previous),i.previous.next=i.next,i.next&&(i.next.previous=i.previous),i.next=this.head,this.head.previous=i,i.previous=null,this.head=i)}},e.prototype.mergeSort=function(t){if(this.head!==this.tail){for(var e,i,n=this.head;n;){for(i=n;i.next&&t(i,i.next)<=0;)i=i.next;var o=i.next;n.previous=i.next=null,e.push(n),n=o}for(;e.length>1;);for(this.tail=this.head=e[0];this.tail.next;)this.tail=this.tail.next}},e.prototype._merge=function(t,e,i){var n,o;for(i(t,e)<=0?(o=n=t,t=t.next):(o=n=e,e=e.next);t&&e;)i(t,e)<=0?(n.next=t,t.previous=n,n=t,t=t.next):(n.next=e,e.previous=n,n=e,e=e.next);return t?(n.next=t,t.previous=n):(n.next=e,e.previous=n),o},e}();e.NodeList=i}(e=t.core||(t.core={}))}(silverback||(silverback={}));var silverback;!function(t){var e;!function(t){var e=function(){function t(t,e){this._nodeClass=t,this._components=e}return t.prototype.get=function(){if(this._tail){var t=this._tail;return this._tail=this._tail.previous,t.previous=null,t}var e=new this._nodeClass;return e},t.prototype.dispose=function(t){this._components.forEach(function(e,i){t[i]=null}),t.entity=null,t.next=null,t.previous=this._tail,this._tail=t},t.prototype.cache=function(t){t.previous=this._cacheTail,this._cacheTail=t},t.prototype.releaseCache=function(){for(;this._cacheTail;){var t=this._cacheTail;this._cacheTail=t.previous,t.next=null,t.previous=this._tail,this._tail=t}},t}();t.NodePool=e}(e=t.core||(t.core={}))}(silverback||(silverback={}));var silverback;!function(t){var e;!function(e){var i=function(){function i(){this.familyClass=e.ComponentMatchingFamily,this._entityList=new e.EntityList,this._sceneList=new e.SceneList,this._systemList=new e.SystemList,this._families=new t.utils.Dictionary,this.updateComplete=new t.utils.Signal}return Object.defineProperty(i.prototype,"entites",{get:function(){for(var t=[],e=this._entityList.head;e;e=e.next)t.push(e);return t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scenes",{get:function(){for(var t=[],e=this._sceneList.head;e;e=e.next)t.push(e);return t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"systems",{get:function(){for(var t=[],e=this._systemList.head;e;e=e.next)t.push(e);return t},enumerable:!0,configurable:!0}),i.prototype.addEntity=function(t){this._entityList.add(t),t.componentAdded.add(this._componentAdded,this),t.componentRemoved.add(this._componentRemoved,this),this._families.forEach(function(e,i){i.newEntity(t)})},i.prototype.removeEntity=function(t){t.componentAdded.remove(this._componentAdded,this),t.componentRemoved.remove(this._componentRemoved,this),this._families.forEach(function(e,i){i.removeEntity(t)}),this._entityList.remove(t)},i.prototype.removeAllEntities=function(){for(;this._entityList.head;)this.removeEntity(this._entityList.head)},i.prototype.addScene=function(t){this._sceneList.add(t)},i.prototype.removeScene=function(t){this._sceneList.remove(t)},i.prototype.removeAllScenes=function(){for(;this._sceneList.head;)this.removeScene(this._sceneList.head)},i.prototype.getScene=function(t){return this._sceneList.get(t)},i.prototype._componentAdded=function(t,e){this._families.forEach(function(i,n){n.componentAddedToEntity(t,e)})},i.prototype._componentRemoved=function(t,e){this._families.forEach(function(i,n){n.componentRemovedFromEntity(t,e)})},i.prototype.getNodeList=function(t){if(this._families.has(t))return this._families.getValue(t)._nodes;var e=new this.familyClass(t,this);this._families.add(t,e);for(var i=this._entityList.head;i;i=i.next)e.newEntity(i);return e.nodeList},i.prototype.releaseNodeList=function(t){this._families.has(t)&&this._families.getValue(t).cleanUp(),this._families.remove(t)},i.prototype.addSystem=function(t,e){t.priority=e,t.addToEngine(this),this._systemList.add(t)},i.prototype.getSystem=function(t){return this._systemList.get(t)},i.prototype.removeSystem=function(t){this._systemList.remove(t),t.removeFromEngine(this)},i.prototype.removeAllSystems=function(){for(;this._systemList.head;)this.removeSystem(this._systemList.head)},i.prototype.update=function(t){this.updating=!0;for(var e=this._systemList.head;e;e=e.next)e.update(t);this.updating=!1,this.updateComplete.dispatch()},i}();e.Engine=i}(e=t.core||(t.core={}))}(silverback||(silverback={}));var silverback;!function(t){var e;!function(t){var e=function(){function t(){this.previous=null,this.next=null,this.priority=0}return t.prototype.addToEngine=function(t){},t.prototype.removeFromEngine=function(t){},t.prototype.update=function(t){},t.prototype.is=function(t){return t.prototype.isPrototypeOf(this)},t}();t.System=e}(e=t.core||(t.core={}))}(silverback||(silverback={})),silverback.core.System.prototype.previous=null,silverback.core.System.prototype.next=null,silverback.core.System.prototype.priority=0;var silverback;!function(t){var e;!function(e){var i=function(){function e(e,i){this._nodeClass=e,this._engine=i,this._nodes=new t.core.NodeList,this._entities=new t.utils.Dictionary,this._components=new t.utils.Dictionary;var n=this._nodeClass.prototype;for(var o in n)if(n.hasOwnProperty(o)&&"types"!==o&&"next"!==o&&"previous"!==o&&"constructor"!==o&&"super"!==o&&"extend"!==o&&"entity"!==o){var s=n.types[o];this._components.add(s,o)}this._nodePool=new t.core.NodePool(this._nodeClass,this._components),this._nodePool.dispose(this._nodePool.get())}return Object.defineProperty(e.prototype,"nodeList",{get:function(){return this._nodes},enumerable:!0,configurable:!0}),e.prototype.newEntity=function(t){this.addIfMatch(t)},e.prototype.componentAddedToEntity=function(t,e){this.addIfMatch(t)},e.prototype.componentRemovedFromEntity=function(t,e){this._components.has(e)&&this.removeIfMatch(t)},e.prototype.removeEntity=function(t){this.removeIfMatch(t)},e.prototype.addIfMatch=function(t){if(!this._entities.has(t)){if(!this._components.forEach(function(e,i){return t.has(e)?void 0:"return"}))return;var e=this._nodePool.get();e.entity=t,this._components.forEach(function(i,n){e[n]=t.get(i)}),this._entities.add(t,e),t.componentRemoved.add(this.componentRemovedFromEntity,this),this._nodes.add(e)}},e.prototype.removeIfMatch=function(t){if(this._entities.getValue(t)){var e=this._entities.getValue(t);this._entities.remove(t),this._nodes.remove(e),this._engine.updating?(this._nodePool.cache(e),this._engine.updateComplete.add(this._releaseNodePoolCache,this)):this._nodePool.dispose(e)}},e.prototype._releaseNodePoolCache=function(){this._engine.updateComplete.remove(this._releaseNodePoolCache),this._nodePool.releaseCache()},e.prototype.cleanUp=function(){for(var t=this._nodes.head;t;t=t.next)this._entities.remove(t.entity);this._nodes.removeAll()},e}();e.ComponentMatchingFamily=i}(e=t.core||(t.core={}))}(silverback||(silverback={}));var silverback;!function(t){var e;!function(t){var e=function(){function t(){}return t.prototype.add=function(t){if(this.head){for(var e=this.tail;e&&!(e.priority<=t.priority);e=e.previous);e===this.tail?(this.tail.next=t,t.previous=this.tail,t.next=null,this.tail=t):e?(t.next=e.next,t.previous=e,e.next.previous=t,e.next=t):(t.next=this.head,t.previous=null,this.head.previous=t,this.head=t)}else this.head=this.tail=t,t.next=t.previous=null},t.prototype.remove=function(t){this.head===t&&(this.head=this.head.next),this.tail===t&&(this.tail=this.tail.previous),t.previous&&(t.previous.next=t.next),t.next&&(t.next.previous=t.previous)},t.prototype.removeAll=function(){for(;this.head;){var t=this.head;this.head=this.head.next,t.previous=null,t.next=null}this.tail=null},t.prototype.get=function(t){for(var e=this.head;e;e=e.next)if(e.is(t))return e;return null},t}();t.SystemList=e}(e=t.core||(t.core={}))}(silverback||(silverback={})),describe("First test",function(){it("should exit without error",function(){console.info("Here")})});
//# sourceMappingURL=silverback.min.js.map
